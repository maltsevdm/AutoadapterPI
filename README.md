# Автоадаптер коэффициента продуктивности скважин для ИМА (GAP)
## Описание
Скрипт для автоматической настройки коэффициента продуктивности скважин (PI) в ПО PETEX GAP методом дихотомии (половинного деления).

## Установка
`git clone https://github.com/maltsevdm/AutoadapterPI.git`<br>
`pip install -r requirements.txt`

## Настройка
### 1. Подготовка входных данных
На вход скрипта подаются данные по скважинам в json-файле. <br>Структура:<br>
```json
[
  {
    "field": "some_field",  // Месторождение  
    "pad": "1",             // Кустовая площадка
    "well": "1001",         // Номер скважины
    "gap_well": "W_1001",   // Название элемента WELL в GAP
    "gap_src": "S_1001",    // Название элемента SOURCE в GAP
    "pi": 39,               // Текущний PI (если неизвестен, то поставить любой)
    "q_liq": 1,             // Целевой дебит жидкости
    "item_type": "WELL",    // Тип элемента в GAP (WELL / SOURCE)
  }
]
```
Во входных данных могут содержаться и другие поля, которые будут служить для группировки скважин по какому-либо признаку.
### 2. Настройка скрипта
Отредактируйте файл `config.py` под свои требования:
```python
MIN_PI = 0.1  # Минимально допустимое значение PI
MAX_PI = 39  # Максимально допустимое значение PI
MAX_ITER = 10  # Количество итераций, после прохождения которых скважина заносится источником
```
В файле `main.py` заполните список `VNR_SRC` источниками ВНР (скважины, которые сейчас на выводе на режим, либо у которых нестабильный режим работы).
Отредактируйте список `ADAPT_TYPES`, в котором укажите необходимые типы адаптации (см. ниже). Порядок имеет значение.
### 3. Типы адаптации
`AdaptationType.by_every_well` - адаптация каждой скважины по отдельности (все скважины и источники маскируются, размаскируется только одна нужная скважина). Рекомендуется делать в первую очередь.<br>
`AdaptationType.by_group` - адаптация скважин в группе. Для этого необходимо в список `GROUPS` добавить поля, по которым будет происходить группировка скважин. Например, можно указать так: `GROUPS = ['field']`. 
Тогда скважины будут группироваться по месторождениям и адаптироваться только в окружении скважин месторождения, то есть все скважины и источники будут замаскированы, кроме скважин, принадлежащих к определенному месторождению.
Также во входных данных можно указать любое дополнительно поле для группировки, например, поле `"block"`, затем в `GROUPS` добавить это поле.<br>
`AdaptationType.by_all_wells` - адаптация всех скважин вместе, то есть все скважины и источники размаскированы. Рекомендуется делать в последнюю очередь.


